{"ast":null,"code":"// ag-grid-enterprise v20.2.0\n\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar ag_grid_community_1 = require(\"ag-grid-community\");\n\nvar excelXmlSerializingSession_1 = require(\"./excelXmlSerializingSession\");\n\nvar excelXlsxSerializingSession_1 = require(\"./excelXlsxSerializingSession\");\n\nvar excelXmlFactory_1 = require(\"./excelXmlFactory\");\n\nvar excelXlsxFactory_1 = require(\"./excelXlsxFactory\");\n\nvar ExcelCreator =\n/** @class */\nfunction (_super) {\n  __extends(ExcelCreator, _super);\n\n  function ExcelCreator() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  ExcelCreator.prototype.postConstruct = function () {\n    this.setBeans({\n      downloader: this.downloader,\n      gridSerializer: this.gridSerializer,\n      gridOptionsWrapper: this.gridOptionsWrapper\n    });\n  };\n\n  ExcelCreator.prototype.exportDataAsExcel = function (params) {\n    if (params && params.exportMode) {\n      this.setExportMode(params.exportMode);\n    }\n\n    return this.export(params);\n  };\n\n  ExcelCreator.prototype.getDataAsExcelXml = function (params) {\n    if (params && params.exportMode) {\n      delete params.exportMode;\n    }\n\n    this.setExportMode('xml');\n    return this.getData(params || {});\n  };\n\n  ExcelCreator.prototype.getMimeType = function () {\n    return this.getExportMode() === 'xml' ? 'application/vnd.ms-excel' : 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet';\n  };\n\n  ExcelCreator.prototype.getDefaultFileName = function () {\n    return \"export.\" + this.getExportMode();\n  };\n\n  ExcelCreator.prototype.getDefaultFileExtension = function () {\n    return this.getExportMode();\n  };\n\n  ExcelCreator.prototype.createSerializingSession = function (params) {\n    var _a = this,\n        columnController = _a.columnController,\n        valueService = _a.valueService,\n        gridOptionsWrapper = _a.gridOptionsWrapper;\n\n    var processCellCallback = params.processCellCallback,\n        processHeaderCallback = params.processHeaderCallback,\n        suppressTextAsCDATA = params.suppressTextAsCDATA,\n        rowHeight = params.rowHeight,\n        headerRowHeight = params.headerRowHeight;\n    var isXlsx = this.getExportMode() === 'xlsx';\n    var excelFactory = isXlsx ? this.xlsxFactory : this.excelXmlFactory;\n    var sheetName = 'ag-grid';\n\n    if (ag_grid_community_1._.exists(params.sheetName)) {\n      sheetName = ag_grid_community_1._.utf8_encode(params.sheetName.toString().substr(0, 31));\n    }\n\n    var config = {\n      columnController: columnController,\n      valueService: valueService,\n      gridOptionsWrapper: gridOptionsWrapper,\n      processCellCallback: processCellCallback,\n      processHeaderCallback: processHeaderCallback,\n      rowHeight: rowHeight,\n      headerRowHeight: headerRowHeight || rowHeight,\n      sheetName: sheetName,\n      excelFactory: excelFactory,\n      baseExcelStyles: this.gridOptions.excelStyles || undefined,\n      styleLinker: this.styleLinker.bind(this),\n      suppressTextAsCDATA: suppressTextAsCDATA || false\n    };\n    return new (isXlsx ? excelXlsxSerializingSession_1.ExcelXlsxSerializingSession : excelXmlSerializingSession_1.ExcelXmlSerializingSession)(config);\n  };\n\n  ExcelCreator.prototype.styleLinker = function (rowType, rowIndex, colIndex, value, column, node) {\n    if (rowType === ag_grid_community_1.RowType.HEADER || rowType === ag_grid_community_1.RowType.HEADER_GROUPING) {\n      return [\"header\"];\n    }\n\n    var styles = this.gridOptions.excelStyles;\n\n    if (!styles || !styles.length) {\n      return null;\n    }\n\n    var styleIds = styles.map(function (it) {\n      return it.id;\n    });\n    var applicableStyles = [];\n    this.stylingService.processAllCellClasses(column.getColDef(), {\n      value: value,\n      data: node.data,\n      node: node,\n      colDef: column.getColDef(),\n      rowIndex: rowIndex,\n      api: this.gridOptionsWrapper.getApi(),\n      context: this.gridOptionsWrapper.getContext()\n    }, function (className) {\n      if (styleIds.indexOf(className) > -1) {\n        applicableStyles.push(className);\n      }\n    });\n    return applicableStyles.sort(function (left, right) {\n      return styleIds.indexOf(left) < styleIds.indexOf(right) ? -1 : 1;\n    });\n  };\n\n  ExcelCreator.prototype.isExportSuppressed = function () {\n    return this.gridOptionsWrapper.isSuppressExcelExport();\n  };\n\n  ExcelCreator.prototype.setExportMode = function (exportMode) {\n    this.exportMode = exportMode;\n  };\n\n  ExcelCreator.prototype.getExportMode = function () {\n    return this.exportMode || 'xlsx';\n  };\n\n  ExcelCreator.prototype.packageFile = function (data) {\n    if (this.getExportMode() === 'xml') {\n      return _super.prototype.packageFile.call(this, data);\n    }\n\n    var _a = this,\n        zipContainer = _a.zipContainer,\n        xlsxFactory = _a.xlsxFactory;\n\n    zipContainer.addFolders(['xl/worksheets/', 'xl/', 'xl/theme/', 'xl/_rels/', 'docProps/', '_rels/']);\n    zipContainer.addFile('xl/worksheets/sheet1.xml', data);\n    zipContainer.addFile('xl/workbook.xml', xlsxFactory.createWorkbook());\n    zipContainer.addFile('xl/styles.xml', xlsxFactory.createStylesheet());\n    zipContainer.addFile('xl/sharedStrings.xml', xlsxFactory.createSharedStrings());\n    zipContainer.addFile('xl/theme/theme1.xml', xlsxFactory.createTheme());\n    zipContainer.addFile('xl/_rels/workbook.xml.rels', xlsxFactory.createWorkbookRels());\n    zipContainer.addFile('docProps/core.xml', xlsxFactory.createCore());\n    zipContainer.addFile('[Content_Types].xml', xlsxFactory.createContentTypes());\n    zipContainer.addFile('_rels/.rels', xlsxFactory.createRels());\n    return zipContainer.getContent('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');\n  };\n\n  __decorate([ag_grid_community_1.Autowired('excelXmlFactory'), __metadata(\"design:type\", excelXmlFactory_1.ExcelXmlFactory)], ExcelCreator.prototype, \"excelXmlFactory\", void 0);\n\n  __decorate([ag_grid_community_1.Autowired('excelXlsxFactory'), __metadata(\"design:type\", excelXlsxFactory_1.ExcelXlsxFactory)], ExcelCreator.prototype, \"xlsxFactory\", void 0);\n\n  __decorate([ag_grid_community_1.Autowired('columnController'), __metadata(\"design:type\", ag_grid_community_1.ColumnController)], ExcelCreator.prototype, \"columnController\", void 0);\n\n  __decorate([ag_grid_community_1.Autowired('valueService'), __metadata(\"design:type\", ag_grid_community_1.ValueService)], ExcelCreator.prototype, \"valueService\", void 0);\n\n  __decorate([ag_grid_community_1.Autowired('gridOptions'), __metadata(\"design:type\", Object)], ExcelCreator.prototype, \"gridOptions\", void 0);\n\n  __decorate([ag_grid_community_1.Autowired('stylingService'), __metadata(\"design:type\", ag_grid_community_1.StylingService)], ExcelCreator.prototype, \"stylingService\", void 0);\n\n  __decorate([ag_grid_community_1.Autowired('downloader'), __metadata(\"design:type\", ag_grid_community_1.Downloader)], ExcelCreator.prototype, \"downloader\", void 0);\n\n  __decorate([ag_grid_community_1.Autowired('gridSerializer'), __metadata(\"design:type\", ag_grid_community_1.GridSerializer)], ExcelCreator.prototype, \"gridSerializer\", void 0);\n\n  __decorate([ag_grid_community_1.Autowired('gridOptionsWrapper'), __metadata(\"design:type\", ag_grid_community_1.GridOptionsWrapper)], ExcelCreator.prototype, \"gridOptionsWrapper\", void 0);\n\n  __decorate([ag_grid_community_1.Autowired('zipContainer'), __metadata(\"design:type\", ag_grid_community_1.ZipContainer)], ExcelCreator.prototype, \"zipContainer\", void 0);\n\n  __decorate([ag_grid_community_1.PostConstruct, __metadata(\"design:type\", Function), __metadata(\"design:paramtypes\", []), __metadata(\"design:returntype\", void 0)], ExcelCreator.prototype, \"postConstruct\", null);\n\n  ExcelCreator = __decorate([ag_grid_community_1.Bean('excelCreator')], ExcelCreator);\n  return ExcelCreator;\n}(ag_grid_community_1.BaseCreator);\n\nexports.ExcelCreator = ExcelCreator;","map":null,"metadata":{},"sourceType":"script"}