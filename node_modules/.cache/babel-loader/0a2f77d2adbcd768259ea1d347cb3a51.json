{"ast":null,"code":"// ag-grid-enterprise v20.2.0\n\"use strict\";\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar ag_grid_community_1 = require(\"ag-grid-community\");\n\nvar ag_grid_community_2 = require(\"ag-grid-community\");\n\nvar workbook_1 = require(\"./files/xml/workbook\");\n\nvar excelWorkbook_1 = require(\"./files/xml/excelWorkbook\");\n\nvar worksheet_1 = require(\"./files/xml/worksheet\");\n\nvar documentProperties_1 = require(\"./files/xml/documentProperties\");\n\nvar alignment_1 = require(\"./files/xml/styles/alignment\");\n\nvar borders_1 = require(\"./files/xml/styles/borders\");\n\nvar font_1 = require(\"./files/xml/styles/font\");\n\nvar interior_1 = require(\"./files/xml/styles/interior\");\n\nvar protection_1 = require(\"./files/xml/styles/protection\");\n\nvar numberFormat_1 = require(\"./files/xml/styles/numberFormat\");\n\nvar style_1 = require(\"./files/xml/styles/style\");\n/**\n * See https://msdn.microsoft.com/en-us/library/aa140066(v=office.10).aspx\n */\n\n\nvar ExcelXmlFactory =\n/** @class */\nfunction () {\n  function ExcelXmlFactory() {}\n\n  ExcelXmlFactory.prototype.createExcel = function (styles, worksheets, sharedStrings) {\n    var header = this.excelXmlHeader();\n    var docProps = documentProperties_1.default.getTemplate();\n    var eWorkbook = excelWorkbook_1.default.getTemplate();\n    var wb = this.workbook(docProps, eWorkbook, styles, worksheets);\n    return \"\" + header + this.xmlFactory.createXml(wb, function (boolean) {\n      return boolean ? '1' : '0';\n    });\n  };\n\n  ExcelXmlFactory.prototype.workbook = function (docProperties, eWorkbook, styles, worksheets) {\n    var children = [docProperties, eWorkbook, this.stylesXmlElement(styles)].concat(ag_grid_community_1._.map(worksheets, function (it) {\n      return worksheet_1.default.getTemplate(it);\n    }));\n    return ag_grid_community_1._.assign({}, workbook_1.default.getTemplate(), {\n      children: children\n    });\n  };\n\n  ExcelXmlFactory.prototype.excelXmlHeader = function () {\n    return \"<?xml version=\\\"1.0\\\" ?>\\n        <?mso-application progid=\\\"Excel.Sheet\\\" ?>\\n        \";\n  };\n\n  ExcelXmlFactory.prototype.stylesXmlElement = function (styles) {\n    var _this = this;\n\n    return {\n      name: 'Styles',\n      children: styles ? ag_grid_community_1._.map(styles, function (it) {\n        return _this.styleXmlElement(it);\n      }) : []\n    };\n  };\n\n  ExcelXmlFactory.prototype.styleXmlElement = function (styleProperties) {\n    var children = ag_grid_community_1._.compose(this.addProperty('alignment', styleProperties), this.addProperty('borders', styleProperties), this.addProperty('font', styleProperties), this.addProperty('interior', styleProperties), this.addProperty('protection', styleProperties), this.addProperty('numberFormat', styleProperties))([]);\n\n    return ag_grid_community_1._.assign({}, style_1.default.getTemplate(styleProperties), {\n      children: children\n    });\n  };\n\n  ExcelXmlFactory.prototype.addProperty = function (property, styleProperties) {\n    return function (children) {\n      if (!styleProperties[property]) {\n        return children;\n      }\n\n      var options = {\n        alignment: alignment_1.default,\n        borders: borders_1.default,\n        font: font_1.default,\n        interior: interior_1.default,\n        numberFormat: numberFormat_1.default,\n        protection: protection_1.default\n      };\n      return children.concat(options[property].getTemplate(styleProperties));\n    };\n  };\n\n  __decorate([ag_grid_community_2.Autowired('xmlFactory'), __metadata(\"design:type\", ag_grid_community_1.XmlFactory)], ExcelXmlFactory.prototype, \"xmlFactory\", void 0);\n\n  ExcelXmlFactory = __decorate([ag_grid_community_2.Bean('excelXmlFactory')], ExcelXmlFactory);\n  return ExcelXmlFactory;\n}();\n\nexports.ExcelXmlFactory = ExcelXmlFactory;","map":null,"metadata":{},"sourceType":"script"}