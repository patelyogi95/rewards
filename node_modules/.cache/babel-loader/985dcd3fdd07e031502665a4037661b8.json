{"ast":null,"code":"// ag-grid-enterprise v20.2.0\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar ag_grid_community_1 = require(\"ag-grid-community\");\n\nvar worksheet_1 = require(\"./worksheet\");\n\nvar cell_1 = require(\"./cell\");\n\nvar addEmptyCells = function addEmptyCells(cells, rowIdx) {\n  var mergeMap = [];\n  var posCounter = 0;\n\n  for (var i = 0; i < cells.length; i++) {\n    var cell = cells[i];\n\n    if (cell.mergeAcross) {\n      mergeMap.push({\n        pos: i,\n        excelPos: posCounter\n      });\n      posCounter += cells[i].mergeAcross;\n    }\n\n    posCounter++;\n  }\n\n  if (mergeMap.length) {\n    for (var i = mergeMap.length - 1; i >= 0; i--) {\n      var mergedCells = [];\n      var cell = cells[mergeMap[i].pos];\n\n      for (var j = 1; j <= cell.mergeAcross; j++) {\n        mergedCells.push({\n          ref: \"\" + worksheet_1.getExcelColumnName(mergeMap[i].excelPos + 1 + j) + (rowIdx + 1),\n          styleId: cell.styleId,\n          data: {\n            type: 'empty',\n            value: null\n          }\n        });\n      }\n\n      if (mergedCells.length) {\n        cells.splice.apply(cells, [mergeMap[i].pos + 1, 0].concat(mergedCells));\n      }\n    }\n  }\n};\n\nvar rowFactory = {\n  getTemplate: function getTemplate(config, idx) {\n    var index = config.index,\n        collapsed = config.collapsed,\n        hidden = config.hidden,\n        height = config.height,\n        s = config.s,\n        _a = config.cells,\n        cells = _a === void 0 ? [] : _a;\n    addEmptyCells(cells, idx);\n\n    var children = ag_grid_community_1._.map(cells, cell_1.default.getTemplate);\n\n    return {\n      name: \"row\",\n      properties: {\n        rawMap: {\n          r: index,\n          collapsed: collapsed,\n          hidden: hidden ? '1' : '0',\n          ht: height,\n          customHeight: height != null ? '1' : '0',\n          s: s,\n          customFormat: s != null ? '1' : '0'\n        }\n      },\n      children: children\n    };\n  }\n};\nexports.default = rowFactory;","map":null,"metadata":{},"sourceType":"script"}