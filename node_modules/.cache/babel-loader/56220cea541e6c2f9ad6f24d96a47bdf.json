{"ast":null,"code":"// ag-grid-enterprise v20.2.0\n\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar ag_grid_community_1 = require(\"ag-grid-community\");\n\nvar clipboardService_1 = require(\"../clipboardService\");\n\nvar menuItemComponent_1 = require(\"./menuItemComponent\");\n\nvar menuList_1 = require(\"./menuList\");\n\nvar menuItemMapper_1 = require(\"./menuItemMapper\");\n\nvar rangeController_1 = require(\"../rangeController\");\n\nvar ContextMenuFactory =\n/** @class */\nfunction () {\n  function ContextMenuFactory() {}\n\n  ContextMenuFactory.prototype.init = function () {};\n\n  ContextMenuFactory.prototype.hideActiveMenu = function () {\n    if (!this.activeMenu) {\n      return;\n    }\n\n    this.activeMenu.destroy();\n  };\n\n  ContextMenuFactory.prototype.getMenuItems = function (node, column, value) {\n    var defaultMenuOptions = [];\n\n    if (ag_grid_community_1._.exists(node)) {\n      if (column) {\n        // only makes sense if column exists, could have originated from a row\n        defaultMenuOptions.push('copy', 'copyWithHeaders', 'paste', 'separator');\n      } // if user clicks a cell\n\n\n      var suppressExcel = this.gridOptionsWrapper.isSuppressExcelExport();\n      var suppressCsv = this.gridOptionsWrapper.isSuppressCsvExport();\n\n      var onIPad = ag_grid_community_1._.isUserAgentIPad();\n\n      var anyExport = !onIPad && (!suppressExcel || !suppressCsv);\n\n      if (anyExport) {\n        defaultMenuOptions.push('export');\n      }\n    } else {// if user clicks outside of a cell (eg below the rows, or not rows present)\n      // nothing to show, perhaps tool panels???\n    }\n\n    if (this.gridOptionsWrapper.isEnableCharts()) {\n      if (!this.rangeController.isEmpty()) {\n        defaultMenuOptions.push('chartRange');\n      }\n\n      if (this.rowModel.getType() === ag_grid_community_1.Constants.ROW_MODEL_TYPE_CLIENT_SIDE) {\n        defaultMenuOptions.push('chartEverything');\n      }\n    }\n\n    if (this.gridOptionsWrapper.getContextMenuItemsFunc()) {\n      var userFunc = this.gridOptionsWrapper.getContextMenuItemsFunc();\n      var params = {\n        node: node,\n        column: column,\n        value: value,\n        defaultItems: defaultMenuOptions.length ? defaultMenuOptions : undefined,\n        api: this.gridOptionsWrapper.getApi(),\n        columnApi: this.gridOptionsWrapper.getColumnApi(),\n        context: this.gridOptionsWrapper.getContext()\n      };\n      return userFunc ? userFunc(params) : undefined;\n    }\n\n    return defaultMenuOptions;\n  };\n\n  ContextMenuFactory.prototype.showMenu = function (node, column, value, mouseEvent) {\n    var _this = this;\n\n    var menuItems = this.getMenuItems(node, column, value);\n\n    if (menuItems === undefined || ag_grid_community_1._.missingOrEmpty(menuItems)) {\n      return;\n    }\n\n    var menu = new ContextMenu(menuItems);\n    this.context.wireBean(menu);\n    var eMenuGui = menu.getGui(); // need to show filter before positioning, as only after filter\n    // is visible can we find out what the width of it is\n\n    var hidePopup = this.popupService.addAsModalPopup(eMenuGui, true, function () {\n      return menu.destroy();\n    }, mouseEvent);\n    this.popupService.positionPopupUnderMouseEvent({\n      column: column,\n      rowNode: node,\n      type: 'contextMenu',\n      mouseEvent: mouseEvent,\n      ePopup: eMenuGui\n    });\n    menu.afterGuiAttached({\n      hidePopup: hidePopup\n    });\n    this.activeMenu = menu;\n    menu.addEventListener(ag_grid_community_1.BeanStub.EVENT_DESTROYED, function () {\n      if (_this.activeMenu === menu) {\n        _this.activeMenu = null;\n      }\n    });\n  };\n\n  __decorate([ag_grid_community_1.Autowired('context'), __metadata(\"design:type\", ag_grid_community_1.Context)], ContextMenuFactory.prototype, \"context\", void 0);\n\n  __decorate([ag_grid_community_1.Autowired('popupService'), __metadata(\"design:type\", ag_grid_community_1.PopupService)], ContextMenuFactory.prototype, \"popupService\", void 0);\n\n  __decorate([ag_grid_community_1.Autowired('gridOptionsWrapper'), __metadata(\"design:type\", ag_grid_community_1.GridOptionsWrapper)], ContextMenuFactory.prototype, \"gridOptionsWrapper\", void 0);\n\n  __decorate([ag_grid_community_1.Autowired('rowModel'), __metadata(\"design:type\", Object)], ContextMenuFactory.prototype, \"rowModel\", void 0);\n\n  __decorate([ag_grid_community_1.Autowired('rangeController'), __metadata(\"design:type\", rangeController_1.RangeController)], ContextMenuFactory.prototype, \"rangeController\", void 0);\n\n  __decorate([ag_grid_community_1.PostConstruct, __metadata(\"design:type\", Function), __metadata(\"design:paramtypes\", []), __metadata(\"design:returntype\", void 0)], ContextMenuFactory.prototype, \"init\", null);\n\n  ContextMenuFactory = __decorate([ag_grid_community_1.Bean('contextMenuFactory')], ContextMenuFactory);\n  return ContextMenuFactory;\n}();\n\nexports.ContextMenuFactory = ContextMenuFactory;\n\nvar ContextMenu =\n/** @class */\nfunction (_super) {\n  __extends(ContextMenu, _super);\n\n  function ContextMenu(menuItems) {\n    var _this = _super.call(this, '<div class=\"ag-menu\"></div>') || this;\n\n    _this.menuItems = menuItems;\n    return _this;\n  }\n\n  ContextMenu.prototype.addMenuItems = function () {\n    var menuList = new menuList_1.MenuList();\n    this.getContext().wireBean(menuList);\n    var menuItemsMapped = this.menuItemMapper.mapWithStockItems(this.menuItems, null);\n    menuList.addMenuItems(menuItemsMapped);\n    this.appendChild(menuList);\n    menuList.addEventListener(menuItemComponent_1.MenuItemComponent.EVENT_ITEM_SELECTED, this.destroy.bind(this));\n  };\n\n  ContextMenu.prototype.afterGuiAttached = function (params) {\n    this.addDestroyFunc(params.hidePopup); // if the body scrolls, we want to hide the menu, as the menu will not appear in the right location anymore\n\n    this.addDestroyableEventListener(this.eventService, 'bodyScroll', this.destroy.bind(this));\n  };\n\n  __decorate([ag_grid_community_1.Autowired('clipboardService'), __metadata(\"design:type\", clipboardService_1.ClipboardService)], ContextMenu.prototype, \"clipboardService\", void 0);\n\n  __decorate([ag_grid_community_1.Autowired('gridOptionsWrapper'), __metadata(\"design:type\", ag_grid_community_1.GridOptionsWrapper)], ContextMenu.prototype, \"gridOptionsWrapper\", void 0);\n\n  __decorate([ag_grid_community_1.Autowired('gridApi'), __metadata(\"design:type\", ag_grid_community_1.GridApi)], ContextMenu.prototype, \"gridApi\", void 0);\n\n  __decorate([ag_grid_community_1.Autowired('eventService'), __metadata(\"design:type\", ag_grid_community_1.EventService)], ContextMenu.prototype, \"eventService\", void 0);\n\n  __decorate([ag_grid_community_1.Autowired('menuItemMapper'), __metadata(\"design:type\", menuItemMapper_1.MenuItemMapper)], ContextMenu.prototype, \"menuItemMapper\", void 0);\n\n  __decorate([ag_grid_community_1.PostConstruct, __metadata(\"design:type\", Function), __metadata(\"design:paramtypes\", []), __metadata(\"design:returntype\", void 0)], ContextMenu.prototype, \"addMenuItems\", null);\n\n  return ContextMenu;\n}(ag_grid_community_1.Component);","map":null,"metadata":{},"sourceType":"script"}